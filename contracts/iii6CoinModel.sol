// SPDX-License-Identifier: GPL-3.0
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//
//      MMWKd:..                                                                                    ..:dKWMM
//      MKl.                                                                                            .lKW
//      O'       ..''''''''''''.     .''''''.     .'''''.      .''''''''''''''.     .''''''''''''..       'O
//      '     .ckKNNWNWWWWWWWWWk.   .xNWWNWNl    ,0WWWWW0,     lNWWWWWWWWWNWNk'    ;0NNNWWWWWWWWNNKkc.     '
//           ,OWMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMMMM0,    ;KMMMMMMMMMMMMMMMMWO,
//          .kMMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMMM0,    ;KMMMMMMMMMMMMMMMMMMMk.
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMMM0,    :KMMMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMMM0,    :KMMMMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMMM0,    ;0NNWWMMMMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMM0,     .'.',;lkNMMMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMMK;              ,kWMMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMMX:    .:oxxdc'    .dWMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMWd.   ,OWMMMMMXl.   '0MMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMX;   .kMMMMMMMMK,   .xMMMMMMMMMMMM0'
//          '0MMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMM0'   .OMMMMMMMMX;   .xMMMMMMMMMMMM0'
//          .OMMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMK,    lNMMMMMMWx.   '0MMMMMMMMMMMMO.
//           lNMMMMMMMMMMMMMMMMO.   .kMMMMMWl    ,KMMMMMK,     lWMMMWd.   .:x0KKKkc.   .dWMMMMMMMMMMMNl
//      .    .c0WMMMMMMMMMMMMMMO.   .kMMMMMWo    ,KMMMMMK,     lWMMMMNd.     ....     .xNMMMMMMMMMMW0c.    .
//      l      .,lddxxxxxxxxxxxc.    :xxxxxd,    .lxxxxxl.     ,dxxxxxd:.            .cdxxxxxxxxddl,.      l
//      No.                                                                                              .oN
//      MW0l'                                                                                          'l0WM
//      MMMWKd;.                                                                                    .;dKWMMM
//
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//                                                                                                                                                                                  //
//      @dev            ::              Aron Mauritala Ayuk                                                                                                                                          //
//      @msg            ::              stereo@iii6.xyz                                                                                                                                   //
//      @github         ::              @stereoIII6
//      @twitter        ::              @stereoIII6                                                                                                                                              //
//                                                                                                                                                                                  //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//                                                                                                                                                                                  //
//      @dev            ::              Juan Xavier Valverde                                                                                                                                    //
//      @msg            ::              juanxavier@iii6.xyz                                                                                                                               //
//      @twitter        ::              @JuanXavier                                                                                                                                             //
//      @github         ::              @JuanXavier                                                                                                                                             //
//                                                                                                                                                                                  //                                                                                                                                                                                 //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//                                                                                                                                                                                  //
//      @company        ::              Fractio Holding                                                                                                                                                                       //
//      @title          ::              iii6 Coin Model                                                                                                                            //
//      @description    ::              ERC20 Model Preset Contract                                                                                                                           //
//      @version        ::              0.0.1                                                                                                                                       //
//      @purpose        ::              ERC20 Model Preset                                                                                                          //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
//                                                                                                                                                                                  //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //
//  *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   *   //
// // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // // //

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

pragma solidity ^0.8.7;

import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol";
import "@openzeppelin/contracts/token/ERC20/extensions/ERC20Pausable.sol";
import "./iii6PriceConsumer.sol";
import "./iii6PriceMath.sol";
import "./iii6safes.sol";
import "./iii6GlobalEnums.sol";

contract iii6CoinModel is
    ERC20,
    ERC20Pausable,
    ERC20Burnable,
    Ownable,
    iii6PriceMath,
    iii6GlobalEnums
{
    uint256 public rate; // @audit. declare as internal since there are getter functions
    uint256 public PUB_SUPPLY; // @audit. declare as internal since there are getter functions
    uint256 public MAX_SUPPLY; // @audit. declare as internal since there are getter functions
    string public title;
    Coins private ocoin;
    bool burns;
    bool pauses;
    struct Rates {
        uint256 rateid;
        uint256 rate;
        Coins ocoin;
    }
    Rates[] rates;
    uint256 r;

    constructor(
        string memory _name, // Token Name
        string memory _sym, // Token Symbol
        uint256 _rate, // Token Price in USD // 100 == 1 usd // 100000 = 1ETH
        uint256 _supply, // Token Max Supply
        bool _burn, // Burnable Option
        uint256 _curr // 1-eth 2-usd 3-xCur 4-yCur
    )
        // choose orientation currency to denominate price in
        ERC20(_name, _sym)
    {
        _setRate(_rate);
        MAX_SUPPLY = _supply;
        title = _name;
        burns = _burn;
        if (_curr == 0) {
            ocoin = Coins.WETH;
        } else if (_curr == 1) {
            ocoin = Coins.GASCOIN;
        } else if (_curr == 2) {
            ocoin = Coins.XXX;
        } else if (_curr == 3) {
            ocoin = Coins.YYY;
        } else {
            ocoin = Coins.USDC;
        }
        rates[r] = Rates(r, _rate, ocoin);
    }

    function _setRate(uint256 _newRate) internal returns (uint256) {
        iii6PriceMath pm;
        if (ocoin == Coins.WETH) {
            rates[r] = Rates(r, _newRate, ocoin);
            r++;
            return rate = pm.ethPriceOfUSD(_newRate);
        } else if (ocoin == Coins.GASCOIN) {
            rates[r] = Rates(r, _newRate, ocoin);
            r++;
            return rate = pm.coinPriceOfUSD(_newRate);
        } else if (ocoin == Coins.XXX) {
            uint256 xP = pm.xPriceOfUSD(_newRate);
            require(xP > 0);
            rates[r] = Rates(r, _newRate, ocoin);
            r++;
            return rate = xP;
        } else if (ocoin == Coins.YYY) {
            uint256 yP = pm.yPriceOfUSD(_newRate);
            require(yP > 0);
            rates[r] = Rates(r, _newRate, ocoin);
            r++;
            return rate = yP;
        } else if (ocoin == Coins.USDC) {
            rates[r] = Rates(r, _newRate, ocoin);
            r++;
            return _newRate;
        } else {
            return rate;
        }
    }

    function adjustRate() external returns (uint256) {
        uint256 newRate = rates[r].rate;
        return _setRate(newRate);
    }

    function burn(uint256 _amount) public override {
        require(burns == true, "not burnable");
        _burn(msg.sender, _amount);
    }

    /// Copied from ERC20Pausable
    function _beforeTokenTransfer(
        address from,
        address to,
        uint256 amount
    ) internal override(ERC20, ERC20Pausable) whenNotPaused {
        super._beforeTokenTransfer(from, to, amount);
    }
}

contract iii6CoinModelDrop is iii6CoinModel {
    constructor(
        string memory _name,
        string memory _sym,
        uint256 _rate,
        uint256 _supply,
        bool _burn,
        uint256 _curr
    ) iii6CoinModel(_name, _sym, _rate, _supply, _burn, _curr) {}

    function dropUSDC() external {
        _mint(msg.sender, 100 * 10**18);
    }
}
